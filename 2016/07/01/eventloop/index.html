<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/xfe/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>






<link href="/xfe/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/xfe/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="js,translate,spec,eventloop," />





  <link rel="alternate" href="/xfe/atom.xml" title="{XFE}" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/xfe/favicon.ico?v=0.5.0" />






<meta name="description" content="&amp;#x7FFB;&amp;#x8BD1;webappapis&amp;#x4E2D;&amp;#x5173;&amp;#x4E8E;eventloop&amp;#x7684;&amp;#x90E8;&amp;#x5206; https://www.w3.org/TR/html5/webappapis.html#event-loops
6.1.4 Event loops
6.1.4 Event loops6.1.4.1 &amp;#x5B9A;&amp;#x4E49;&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="webapp api规范中关于eventloop翻译(待翻译)">
<meta property="og:url" content="http://sinaad.github.io/2016/07/01/eventloop/index.html">
<meta property="og:site_name" content="{XFE}">
<meta property="og:description" content="&amp;#x7FFB;&amp;#x8BD1;webappapis&amp;#x4E2D;&amp;#x5173;&amp;#x4E8E;eventloop&amp;#x7684;&amp;#x90E8;&amp;#x5206; https://www.w3.org/TR/html5/webappapis.html#event-loops
6.1.4 Event loops
6.1.4 Event loops6.1.4.1 &amp;#x5B9A;&amp;#x4E49;&amp;">
<meta property="og:updated_time" content="2016-07-01T03:51:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="webapp api规范中关于eventloop翻译(待翻译)">
<meta name="twitter:description" content="&amp;#x7FFB;&amp;#x8BD1;webappapis&amp;#x4E2D;&amp;#x5173;&amp;#x4E8E;eventloop&amp;#x7684;&amp;#x90E8;&amp;#x5206; https://www.w3.org/TR/html5/webappapis.html#event-loops
6.1.4 Event loops
6.1.4 Event loops6.1.4.1 &amp;#x5B9A;&amp;#x4E49;&amp;">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> webapp api规范中关于eventloop翻译(待翻译) | {XFE} </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?13989991106bdad30ea927ab9ae93a09";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/xfe/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">{XFE}</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/xfe/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/xfe/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/xfe/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/xfe/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/xfe/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                webapp api规范中关于eventloop翻译(待翻译)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-01T10:11:52+08:00" content="2016-07-01">
              2016-07-01
            </time>
          </span>

          
          <span class="post-author">
            &nbsp; | &nbsp;
            红领巾
          </span>
          

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/xfe/categories/translate/" itemprop="url" rel="index">
                    <span itemprop="name">translate</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/xfe/2016/07/01/eventloop/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/01/eventloop/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>&#x7FFB;&#x8BD1;webappapis&#x4E2D;&#x5173;&#x4E8E;eventloop&#x7684;&#x90E8;&#x5206; <a href="https://www.w3.org/TR/html5/webappapis.html#event-loops" target="_blank" rel="external">https://www.w3.org/TR/html5/webappapis.html#event-loops</a></p>
<p>6.1.4 Event loops</p>
<h2 id="6-1-4-Event-loops"><a href="#6-1-4-Event-loops" class="headerlink" title="6.1.4 Event loops"></a>6.1.4 Event loops</h2><h3 id="6-1-4-1-&#x5B9A;&#x4E49;"><a href="#6-1-4-1-&#x5B9A;&#x4E49;" class="headerlink" title="6.1.4.1 &#x5B9A;&#x4E49;"></a>6.1.4.1 &#x5B9A;&#x4E49;</h3><p>&#x5BF9;&#x4E8E;&#x5750;&#x6807;&#x4E8B;&#x4EF6;&#xFF0C;&#x7528;&#x6237;&#x4EA4;&#x4E92;&#xFF0C;&#x811A;&#x672C;&#xFF0C;&#x6E32;&#x67D3;&#xFF0C;&#x7F51;&#x7EDC;&#x7B49;&#x7B49;&#xFF0C;&#x7528;&#x6237;&#x4EE3;&#x7406;&#x4F1A;&#x7528;&#x5230;&#x672C;&#x8282;&#x63CF;&#x8FF0;&#x7684;event loops&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x4EE3;&#x7406;&#x81F3;&#x5C11;&#x5B58;&#x5728;&#x4E00;&#x4E2A;event loop&#xFF0C;and at most one event loop per unit of related similar-origin browsing contexts.</p>
<p>When there is more than one event loop for a unit of related browsing contexts, complications arise when a browsing context in that group is navigated such that it switches from one unit of related similar-origin browsing contexts to another. This specification does not currently describe how to handle these complications.</p>
<p>&#x4E00;&#x4E2A;event loop&#x603B;&#x662F;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x4E2A;&#x6D4F;&#x89C8;&#x4E0A;&#x4E0B;&#x6587;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;event loop&#x7684;&#x6D4F;&#x89C8;&#x4E0A;&#x4E0B;&#x6587;&#x5168;&#x90E8;&#x9500;&#x6BC1;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;event loop&#x4E5F;&#x540C;&#x65F6;&#x9500;&#x6BC1;&#x3002;&#x4E00;&#x4E2A;&#x6D4F;&#x89C8;&#x4E0A;&#x4E0B;&#x6587;&#x603B;&#x662F;&#x6709;&#x4E00;&#x4E2A;event loop&#x6765;&#x534F;&#x8C03;&#x4ED6;&#x7684;&#x6D3B;&#x52A8;&#x3002;</p>
<p>&#x4E00;&#x4E2A;event loop&#x6709;&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x3002;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x5E8F;&#x7684;&#x4EFB;&#x52A1;&#x5217;&#x8868;&#xFF0C;which are algorithms that are responsible for such work as:</p>
<p><strong>Events</strong><br>Asynchronously dispatching an Event object at a particular EventTarget object is often done by a dedicated task.</p>
<blockquote>
<p>Not all events are dispatched using the task queue, many are dispatched synchronously during other tasks.</p>
</blockquote>
<p><strong>Parsing</strong><br>The HTML parser tokenizing one or more bytes, and then processing any resulting tokens, is typically a task.</p>
<p><strong>Callbacks</strong><br>Calling a callback asynchronously is often done by a dedicated task.</p>
<p><strong>Using a resource</strong><br>When an algorithm fetches a resource, if the fetching occurs asynchronously then the processing of the resource once some or all of the resource is available is performed by a task.</p>
<p><strong>Reacting to DOM manipulation</strong><br>Some elements have tasks that trigger in response to DOM manipulation, e.g. when that element is inserted into the document.</p>
<p>Each task is associated with a Document; if the task was queued in the context of an element, then it is the element&#x2019;s Document; if the task was queued in the context of a browsing context, then it is the browsing context&#x2019;s active document at the time the task was queued; if the task was queued by or for a script then the document is the responsible document specified by the script&#x2019;s settings object.</p>
<p>A task is intended for a specific event loop: the event loop that is handling tasks for the task&#x2019;s associated Document.</p>
<p>When a user agent is to queue a task, it must add the given task to one of the task queues of the relevant event loop.</p>
<p>Each task is defined as coming from a specific task source. All the tasks from one particular task source and destined to a particular event loop (e.g. the callbacks generated by timers of a Document, the events fired for mouse movements over that Document, the tasks queued for the parser of that Document) must always be added to the same task queue, but tasks from different task sources may be placed in different task queues.</p>
<blockquote>
<p>For example, a user agent could have one task queue for mouse and key events (the user interaction task source), and another for everything else. The user agent could then give keyboard and mouse events preference over other tasks three quarters of the time, keeping the interface responsive but not starving other task queues, and never processing events from any one task source out of order.</p>
</blockquote>
<p>A user agent may have one storage mutex. This mutex is used to control access to shared state like cookies. At any one point, the storage mutex is either free, or owned by a particular event loop or instance of the fetching algorithm.</p>
<p>If a user agent does not implement a storage mutex, it is exempt from implementing the requirements that require it to acquire or release it.</p>
<blockquote>
<p>Note:User agent implementors have to make a choice between two evils. On the one hand, not implementing the storage mutex means that there is a risk of data corruption: a site could, for instance, try to read a cookie, increment its value, then write it back out, using the new value of the cookie as a unique identifier for the session; if the site does this twice in two different browser windows at the same time, it might end up using the same &#x201C;unique&#x201D; identifier for both sessions, with potentially disastrous effects. On the other hand, implementing the storage mutex has potentially serious performance implications: whenever a site uses Web Storage or cookies, all other sites that try to use Web Storage or cookies are blocked until the first site finishes.</p>
</blockquote>
<p>Whenever a script calls into a plugin, and whenever a plugin calls into a script, the user agent must release the storage mutex.</p>
<h3 id="6-1-4-2-Processing-model"><a href="#6-1-4-2-Processing-model" class="headerlink" title="6.1.4.2 Processing model"></a>6.1.4.2 Processing model</h3><p>An event loop must continually run through the following steps for as long as it exists:</p>
<ol>
<li>Run the oldest task on one of the event loop&#x2019;s task queues, if any, ignoring tasks whose associated Documents are not fully active. The user agent may pick any task queue.</li>
<li>If the storage mutex is now owned by the event loop, release it so that it is once again free.</li>
<li>If a task was run in the first step above, remove that task from its task queue.</li>
<li>If this event loop is not a worker&#x2019;s event loop, run these substeps:<ol>
<li>Perform a microtask checkpoint.</li>
<li>Provide a stable state.</li>
<li>If necessary, update the rendering or user interface of any Document or browsing context to reflect the current state.</li>
</ol>
</li>
<li>Otherwise, if this event loop is running for a WorkerGlobalScope, but there are no events in the event loop&#x2019;s task queues and the WorkerGlobalScope object&#x2019;s closing flag is true, then destroy the event loop, aborting these steps.</li>
<li>Return to the first step of the event loop.</li>
</ol>
<p>When a user agent is to perform a microtask checkpoint, if the performing a microtask checkpoint flag is false, then the user agent must run the following steps:</p>
<ol>
<li>Let the performing a microtask checkpoint flag be true.</li>
<li>Perform a custom elements checkpoint. [CUSTOM]</li>
<li>Sort the tables with pending sorts.</li>
<li>Invoke MutationObserver objects for the unit of related similar-origin browsing contexts to which the responsible browsing context specified by the script&#x2019;s settings object belongs, using the task wrapper algorithm as the steps to invoke each callback.</li>
</ol>
<blockquote>
<p>Note:This will typically invoke scripted callbacks, which eventually calls the clean up after running a callback steps, which call this perform a microtask checkpoint algorithm again, which is why we use the performing a microtask checkpoint flag to avoid reentrancy.</p>
</blockquote>
<ol>
<li>Let the performing a microtask checkpoint flag be false.</li>
</ol>
<p>When the user agent is to provide a stable state, if any asynchronously-running algorithms are awaiting a stable state, then the user agent must run their synchronous section and then resume running their asynchronous algorithm (if appropriate).</p>
<blockquote>
<p>Note:A synchronous section never mutates the DOM, runs any script, or has any side-effects detectable from another synchronous section, and thus synchronous sections can be run in any order, and cannot spin the event loop.</p>
<p>Note:Steps in synchronous sections are marked with &#x231B;.</p>
</blockquote>
<p>The task wrapper algorithm, which is implicitly invoked in the context of an event loop and is used to invoke a given callback in a specific way, is as follows:</p>
<p>1.Invoke callback as specified.</p>
<blockquote>
<p>The above will change in due course; see bug 20821.</p>
</blockquote>
<p>When an algorithm says to spin the event loop until a condition goal is met, the user agent must run the following steps:</p>
<ol>
<li>Let task source be the task source of the currently running task.</li>
<li>Let old stack of script settings objects be a copy of the stack of script settings objects.</li>
<li>Empty the stack of script settings objects.</li>
<li>Run the global script clean-up jobs.</li>
<li>Perform a microtask checkpoint.</li>
<li>Stop the currently running task, allowing the event loop to resume, but continue these steps asynchronously.</li>
</ol>
<blockquote>
<p>This causes the event loop to move on to the second step of its processing model (defined above).</p>
</blockquote>
<ol>
<li>Wait until the condition goal is met.</li>
<li>Queue a task to continue running these steps, using the task source task source. Wait until this task runs before continuing these steps.</li>
<li>Replace the stack of script settings objects with the old stack of script settings objects.</li>
<li>Return to the caller.</li>
</ol>
<p>Some of the algorithms in this specification, for historical reasons, require the user agent to pause while running a task until a condition goal is met. This means running the following steps:</p>
<ol>
<li>If any asynchronously-running algorithms are awaiting a stable state, then run their synchronous section and then resume running their asynchronous algorithm. (See the event loop processing model definition above for details.)</li>
<li>If necessary, update the rendering or user interface of any Document or browsing context to reflect the current state.</li>
<li>Wait until the condition goal is met. While a user agent has a paused task, the corresponding event loop must not run further tasks, and any script in the currently running task must block. User agents should remain responsive to user input while paused, however, albeit in a reduced capacity since the event loop will not be doing anything.</li>
</ol>
<p>When a user agent is to obtain the storage mutex as part of running a task, it must run through the following steps:</p>
<ol>
<li>If the storage mutex is already owned by this task&#x2019;s event loop, then abort these steps.</li>
<li>Otherwise, pause until the storage mutex can be taken by the event loop.</li>
<li>Take ownership of the storage mutex.</li>
</ol>
<h3 id="6-1-4-3-Generic-task-sources"><a href="#6-1-4-3-Generic-task-sources" class="headerlink" title="6.1.4.3 Generic task sources"></a>6.1.4.3 Generic task sources</h3><p>The following task sources are used by a number of mostly unrelated features in this and other specifications.</p>
<p><strong>The DOM manipulation task source</strong><br>This task source is used for features that react to DOM manipulations, such as things that happen asynchronously when an element is inserted into the document.</p>
<p><strong>The user interaction task source</strong><br>This task source is used for features that react to user interaction, for example keyboard or mouse input.</p>
<p>Asynchronous events sent in response to user input (e.g. click events) must be fired using tasks queued with the user interaction task source. [DOMEVENTS]</p>
<p><strong>The networking task source</strong><br>This task source is used for features that trigger in response to network activity.</p>
<p><strong>The history traversal task source</strong><br>This task source is used to queue calls to history.back() and similar APIs.</p>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/xfe/tags/js/" rel="tag">#js</a>
          
            <a href="/xfe/tags/translate/" rel="tag">#translate</a>
          
            <a href="/xfe/tags/spec/" rel="tag">#spec</a>
          
            <a href="/xfe/tags/eventloop/" rel="tag">#eventloop</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/xfe/2016/06/29/beforeunlod-vs-unload/" rel="next" title="各个浏览器中对于beforeunload事件和unload事件的对比">
                <i class="fa fa-chevron-left"></i> 各个浏览器中对于beforeunload事件和unload事件的对比
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/xfe/2016/07/11/the-basics-of-es6-generators/" rel="prev" title="ES6 generators入门">
                ES6 generators入门 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2016/07/01/eventloop/"
     data-title="webapp api规范中关于eventloop翻译(待翻译)"
     data-content=""
     data-url="http://sinaad.github.io/xfe/2016/07/01/eventloop/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/07/01/eventloop/"
           data-title="webapp api规范中关于eventloop翻译(待翻译)" data-url="http://sinaad.github.io/xfe/2016/07/01/eventloop/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://tp4.sinaimg.cn/2231440955/180/5749469848/1"
               alt="SINA FE Team" />
          <p class="site-author-name" itemprop="name">SINA FE Team</p>
          <p class="site-description motion-element" itemprop="description">我们一直努力贴好小广告</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/xfe/archives">
              <span class="site-state-item-count">28</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/xfe/categories">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/xfe/tags">
                <span class="site-state-item-count">42</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/xfe/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/orgs/sinaad/teams/xfe" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/acelan" target="_blank">
                  
                    <i class="fa fa-weibo"></i> Weibo
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-4-Event-loops"><span class="nav-number">1.</span> <span class="nav-text">6.1.4 Event loops</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-4-1-定义"><span class="nav-number">1.1.</span> <span class="nav-text">6.1.4.1 定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-4-2-Processing-model"><span class="nav-number">1.2.</span> <span class="nav-text">6.1.4.2 Processing model</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-4-3-Generic-task-sources"><span class="nav-number">1.3.</span> <span class="nav-text">6.1.4.3 Generic task sources</span></a></li></ol></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SINA FE Team</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/xfe/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/xfe/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/xfe/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/xfe/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/xfe/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/xfe/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/xfe/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/xfe/js/src/motion.js?v=0.5.0"></script>



  
  


  <script type="text/javascript" src="/xfe/js/src/affix.js?v=0.5.0"></script>

  <script type="text/javascript" src="/xfe/js/src/schemes/pisces.js?v=0.5.0"></script>



  
  
<script type="text/javascript" src="/xfe/js/src/scrollspy.js?v=0.5.0"></script>

<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = NexT.utils.escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    NexT.motion.middleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');

      if (CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          NexT.utils.displaySidebar();
        }
      }
    };
  });
</script>



  


  <script type="text/javascript" src="/xfe/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"sinaad-xfe"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>

  <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
      MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
        //  do something with the error.  message[2] is the Error object that records the problem.
        console.log(message);
      });
  </script>

  <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });
  </script>

  <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  
  


</body>
</html>
